---
title: 字符串解码
date: 2021-12-15 14:59:18
tags: [算法, leetcode]
copyright: true
---
题目链接：
https://leetcode-cn.com/problems/decode-string/
解法分析：
1. 使用两个栈，一个数字栈，一个字符串栈。当遇到 "[" 时进栈，遇到 "]" 时出栈。
```ts
function decodeString(s: string): string {
    const numStack: number[] = []; // 存储次数的栈
    const strStack: string[] = []; // 存储字符串的栈

    let num = 0; // 暂存次数
    let str = ''; // 暂存字符串

    for (const ch of s) {
        if(!isNaN(+ch)) {
            // 如果是数字
            num = num * 10 + parseInt(ch);
        } else if (ch === '[') {
            // 入栈
            numStack.push(num);
            strStack.push(str);
            // 清零
            str = '';
            num = 0;
        } else if (ch === ']') {
            // 出栈
            const times = numStack.pop(); // 重复次数
            let temp = strStack.pop(); // 取出栈顶字符串
            temp += str.repeat(times); // 拼接字符串
            str = temp;
        } else {
            // 如果是字母
            str += ch;
        }
    }
};
```

2. 只使用一个栈。
我们可以利用 stack 来实现这个操作，遍历这个字符串 s，判断每一个字符的类型：
- 如果是字母 --> 添加到 stack 当中
- 如果是数字 --> 先不着急添加到 stack 中 --> 因为有可能有多位
- 如果是 [ --> 说明重复字符串开始 --> 将数字入栈 --> 并且将数字清零
- 如果是 ] --> 说明重复字符串结束 --> 将重复字符串重复前一步储存的数字遍

具体操作如下：
- 在遇到 ] 之前，我们不断执行压栈操作。
- 当遇到 ] 的时候，说明我们应该出栈了，不断出栈直到找到对应的 [，这中间的字符就是 repeatStr。
- 但是要重复几次呢？ 我们需要继续出栈，直到非数字为止，这个数字我们记录为 repeatCount。
- 而最终的字符串就是 repeatCount 个 repeatStr 拼接的形式。 并将其看成一个字母压入栈中。

```ts
function decodeString(s: string): string {
    const stack: string[] = [];
    for(const ch of s) {
        if(ch === ']') {
            let repeatTimes =  '', repeatStr = '';
            while (stack.length && stack[stack.length - 1] !== '[') {
                // 中间的即是重复部分
                repeatStr = stack.pop() + repeatStr;
            }
            // pop 掉 [
            stack.pop();
            while(stack.length && !isNaN(+stack[stack.length - 1])) {
                // 中间的即是重复次数
                repeatTimes = stack.pop() + repeatTimes;
            }
            stack.push(repeatStr.repeat(+repeatTimes));
        } else {
            stack.push(ch);
        }
    }
    return stack.join('');
};
```

参考题解：
作者：xiao_ben_zhu
链接：
https://leetcode-cn.com/problems/decode-string/solution/zhan-de-ji-yi-nei-ceng-de-jie-ma-liao-bie-wang-lia/
来源：力扣（LeetCode）
著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。